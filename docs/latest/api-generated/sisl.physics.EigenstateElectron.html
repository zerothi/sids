

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>EigenstateElectron &mdash; sisl |release| documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="sisl |release| documentation" href="../index.html"/>
        <link rel="up" title="Physical objects (sisl.physics)" href="sisl.physics.html"/>
        <link rel="next" title="DOS" href="sisl.physics.phonon.DOS.html"/>
        <link rel="prev" title="EigenvectorElectron" href="sisl.physics.EigenvectorElectron.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> sisl
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
</ul>
<p class="caption"><span class="caption-text">Publications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using sisl</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst/files.html">File formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sisl.html">sisl (<code class="docutils literal"><span class="pre">sisl</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sisl.geom.html">Common geometries (<code class="docutils literal"><span class="pre">sisl.geom</span></code>)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="sisl.physics.html">Physical objects (<code class="docutils literal"><span class="pre">sisl.physics</span></code>)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="sisl.physics.html#brillouin-zone-brillouinzone">Brillouin zone (<code class="docutils literal"><span class="pre">brillouinzone</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.physics.html#spin-configuration">Spin configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.physics.html#physical-quantites">Physical quantites</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="sisl.physics.html#electrons-electron">Electrons (<code class="docutils literal"><span class="pre">electron</span></code>)</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.electron.DOS.html">DOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.electron.PDOS.html">PDOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.electron.velocity.html">velocity</a></li>
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.electron.wavefunction.html">wavefunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.electron.spin_moment.html">spin_moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.EigenvalueElectron.html">EigenvalueElectron</a></li>
<li class="toctree-l4"><a class="reference internal" href="sisl.physics.EigenvectorElectron.html">EigenvectorElectron</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">EigenstateElectron</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sisl.physics.html#phonons-phonon">Phonons (<code class="docutils literal"><span class="pre">phonon</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.physics.html#distribution-functions-distribution">Distribution functions (<code class="docutils literal"><span class="pre">distribution</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.physics.html#low-level-objects">Low level objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sisl.io.html">Input/Output (<code class="docutils literal"><span class="pre">sisl.io</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sisl.constant.html">Physical constants (<code class="docutils literal"><span class="pre">sisl.constant</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sisl.unit.html">Unit conversion (<code class="docutils literal"><span class="pre">sisl.unit</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sisl.shape.html">Shapes (<code class="docutils literal"><span class="pre">sisl.shape</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sisl.utils.html">Utility routines (<code class="docutils literal"><span class="pre">sisl.utils</span></code>)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">API documentation</a> &raquo;</li>
        
          <li><a href="sisl.physics.html">Physical objects (<code class="docutils literal"><span class="pre">sisl.physics</span></code>)</a> &raquo;</li>
        
      <li>EigenstateElectron</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api-generated/sisl.physics.EigenstateElectron.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="eigenstateelectron">
<h1>EigenstateElectron<a class="headerlink" href="#eigenstateelectron" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="sisl.physics.EigenstateElectron">
<em class="property">class </em><code class="descclassname">sisl.physics.</code><code class="descname">EigenstateElectron</code><span class="sig-paren">(</span><em>state</em>, <em>c</em>, <em>parent=None</em>, <em>**info</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#EigenstateElectron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.EigenstateElectron" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigen states of electrons with eigenvectors and eigenvalues.</p>
<p>This holds routines that enable the calculation of (projected) density of states,
spin moments (spin texture).</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.DOS" title="sisl.physics.EigenstateElectron.DOS"><code class="xref py py-obj docutils literal"><span class="pre">DOS</span></code></a>(E[,&nbsp;distribution])</td>
<td>Calculate DOS for provided energies, <em class="xref py py-obj">E</em>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.PDOS" title="sisl.physics.EigenstateElectron.PDOS"><code class="xref py py-obj docutils literal"><span class="pre">PDOS</span></code></a>(E[,&nbsp;distribution])</td>
<td>Calculate PDOS for provided energies, <em class="xref py py-obj">E</em>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.Sk" title="sisl.physics.EigenstateElectron.Sk"><code class="xref py py-obj docutils literal"><span class="pre">Sk</span></code></a>([format,&nbsp;spin])</td>
<td>Retrieve the overlap matrix corresponding to the originating parent structure.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">__init__</span></code>(state,&nbsp;c[,&nbsp;parent])</td>
<td>Define a state container with a given set of states and coefficients for the states</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.asCoefficient" title="sisl.physics.EigenstateElectron.asCoefficient"><code class="xref py py-obj docutils literal"><span class="pre">asCoefficient</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.asState" title="sisl.physics.EigenstateElectron.asState"><code class="xref py py-obj docutils literal"><span class="pre">asState</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.change_gauge" title="sisl.physics.EigenstateElectron.change_gauge"><code class="xref py py-obj docutils literal"><span class="pre">change_gauge</span></code></a>(gauge)</td>
<td>In-place change of the gauge of the state coefficients</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.copy" title="sisl.physics.EigenstateElectron.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>()</td>
<td>Return a copy (only the coefficients and states are copied), <code class="docutils literal"><span class="pre">parent</span></code> and <code class="docutils literal"><span class="pre">info</span></code> are passed by reference</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.degenerate" title="sisl.physics.EigenstateElectron.degenerate"><code class="xref py py-obj docutils literal"><span class="pre">degenerate</span></code></a>(eps)</td>
<td>Find degenerate coefficients with a specified precision</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.expectation" title="sisl.physics.EigenstateElectron.expectation"><code class="xref py py-obj docutils literal"><span class="pre">expectation</span></code></a>(A[,&nbsp;diag])</td>
<td>Calculate the expectation value of matrix <em class="xref py py-obj">A</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.inv_eff_mass_tensor" title="sisl.physics.EigenstateElectron.inv_eff_mass_tensor"><code class="xref py py-obj docutils literal"><span class="pre">inv_eff_mass_tensor</span></code></a>([as_matrix,&nbsp;eps])</td>
<td>Calculate inverse effective mass tensor for the states</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.iter" title="sisl.physics.EigenstateElectron.iter"><code class="xref py py-obj docutils literal"><span class="pre">iter</span></code></a>([asarray])</td>
<td>An iterator looping over the states in this system</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.norm" title="sisl.physics.EigenstateElectron.norm"><code class="xref py py-obj docutils literal"><span class="pre">norm</span></code></a>()</td>
<td>Return a vector with the norm of each state <span class="math">\(\sqrt{\langle\psi|\psi\rangle}\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.norm2" title="sisl.physics.EigenstateElectron.norm2"><code class="xref py py-obj docutils literal"><span class="pre">norm2</span></code></a>([sum])</td>
<td>Return a vector with the norm of each state <span class="math">\(\langle\psi|\psi\rangle\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.normalize" title="sisl.physics.EigenstateElectron.normalize"><code class="xref py py-obj docutils literal"><span class="pre">normalize</span></code></a>()</td>
<td>Return a normalized state where each state has <span class="math">\(|\psi|^2=1\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.occupation" title="sisl.physics.EigenstateElectron.occupation"><code class="xref py py-obj docutils literal"><span class="pre">occupation</span></code></a>([distribution])</td>
<td>Calculate the occupations for the states according to a distribution function</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.outer" title="sisl.physics.EigenstateElectron.outer"><code class="xref py py-obj docutils literal"><span class="pre">outer</span></code></a>([idx])</td>
<td>Return the outer product for the indices <em class="xref py py-obj">idx</em> (or all if <code class="docutils literal"><span class="pre">None</span></code>) by <span class="math">\(\sum_i|\psi_i\rangle c_i\langle\psi_i|\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.psi" title="sisl.physics.EigenstateElectron.psi"><code class="xref py py-obj docutils literal"><span class="pre">psi</span></code></a>(grid[,&nbsp;spinor,&nbsp;eta])</td>
<td>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.sort" title="sisl.physics.EigenstateElectron.sort"><code class="xref py py-obj docutils literal"><span class="pre">sort</span></code></a>([ascending])</td>
<td>Sort and return a new <a class="reference internal" href="sisl.physics.StateC.html#sisl.physics.StateC" title="sisl.physics.StateC"><code class="xref py py-obj docutils literal"><span class="pre">StateC</span></code></a> by sorting the coefficients (default to ascending)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.spin_moment" title="sisl.physics.EigenstateElectron.spin_moment"><code class="xref py py-obj docutils literal"><span class="pre">spin_moment</span></code></a>()</td>
<td>Calculate spin moment from the states</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.sub" title="sisl.physics.EigenstateElectron.sub"><code class="xref py py-obj docutils literal"><span class="pre">sub</span></code></a>(idx)</td>
<td>Return a new state with only the specified states</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.velocity" title="sisl.physics.EigenstateElectron.velocity"><code class="xref py py-obj docutils literal"><span class="pre">velocity</span></code></a>([eps])</td>
<td>Calculate velocity for the states</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.velocity_matrix" title="sisl.physics.EigenstateElectron.velocity_matrix"><code class="xref py py-obj docutils literal"><span class="pre">velocity_matrix</span></code></a>([eps])</td>
<td>Calculate velocity matrix for the states</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.EigenstateElectron.wavefunction" title="sisl.physics.EigenstateElectron.wavefunction"><code class="xref py py-obj docutils literal"><span class="pre">wavefunction</span></code></a>(grid[,&nbsp;spinor,&nbsp;eta])</td>
<td>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="sisl.physics.EigenstateElectron.DOS">
<code class="descname">DOS</code><span class="sig-paren">(</span><em>E</em>, <em>distribution='gaussian'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#EigenstateElectron.DOS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.EigenstateElectron.DOS" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate DOS for provided energies, <em class="xref py py-obj">E</em>.</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.DOS.html#sisl.physics.electron.DOS" title="sisl.physics.electron.DOS"><code class="xref py py-obj docutils literal"><span class="pre">sisl.physics.electron.DOS</span></code></a> with appropriate arguments
and returns the DOS.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.DOS.html#sisl.physics.electron.DOS" title="sisl.physics.electron.DOS"><code class="xref py py-obj docutils literal"><span class="pre">DOS</span></code></a> for argument details.</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.PDOS">
<code class="descname">PDOS</code><span class="sig-paren">(</span><em>E</em>, <em>distribution='gaussian'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#EigenstateElectron.PDOS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.EigenstateElectron.PDOS" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate PDOS for provided energies, <em class="xref py py-obj">E</em>.</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.PDOS.html#sisl.physics.electron.PDOS" title="sisl.physics.electron.PDOS"><code class="xref py py-obj docutils literal"><span class="pre">PDOS</span></code></a> with appropriate arguments
and returns the PDOS.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.PDOS.html#sisl.physics.electron.PDOS" title="sisl.physics.electron.PDOS"><code class="xref py py-obj docutils literal"><span class="pre">PDOS</span></code></a> for argument details.</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.Sk">
<code class="descname">Sk</code><span class="sig-paren">(</span><em>format='csr'</em>, <em>spin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.Sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the overlap matrix corresponding to the originating parent structure.</p>
<p>When <code class="docutils literal"><span class="pre">self.parent</span></code> is a Hamiltonian this will return <span class="math">\(\mathbf S(k)\)</span> for the
<span class="math">\(k\)</span>-point these eigenstates originate from</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>format: str, optional</strong></p>
<blockquote>
<div><p>the returned format of the overlap matrix. This only takes effect for
non-orthogonal parents.</p>
</div></blockquote>
<p><strong>spin</strong> : Spin, optional</p>
<blockquote class="last">
<div><p>for non-collinear spin configurations the <em>fake</em> overlap matrix returned
will have halve the size of the input matrix. If you want the <em>full</em> overlap
matrix, simply do not specify the <code class="xref py py-obj docutils literal"><span class="pre">spin</span></code> argument.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.asCoefficient">
<code class="descname">asCoefficient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.asCoefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.asState">
<code class="descname">asState</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.asState" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.c">
<code class="descname">c</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.change_gauge">
<code class="descname">change_gauge</code><span class="sig-paren">(</span><em>gauge</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.change_gauge" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place change of the gauge of the state coefficients</p>
<p>The two gauges are related through:</p>
<div class="math">
\[\tilde C_j = e^{-i\mathbf k\mathbf r_j} C_j\]</div>
<p>where <span class="math">\(C_j\)</span> belongs to the gauge <code class="docutils literal"><span class="pre">R</span></code> and <span class="math">\(\tilde C_j\)</span> is in the gauge
<code class="docutils literal"><span class="pre">r</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gauge</strong> : {‘R’, ‘r’}</p>
<blockquote class="last">
<div><p>specify the new gauge for the state coefficients</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy (only the coefficients and states are copied), <code class="docutils literal"><span class="pre">parent</span></code> and <code class="docutils literal"><span class="pre">info</span></code> are passed by reference</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.degenerate">
<code class="descname">degenerate</code><span class="sig-paren">(</span><em>eps</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.degenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Find degenerate coefficients with a specified precision</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eps</strong> : float</p>
<blockquote>
<div><p>the precision above which coefficients are not considered degenerate</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of numpy.ndarray: a list of indices</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.dkind">
<code class="descname">dkind</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.dkind" title="Permalink to this definition">¶</a></dt>
<dd><p>The data-type of the state (in str)</p>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.dtype">
<code class="descname">dtype</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Data-type for the state</p>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.eig">
<code class="descname">eig</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.eig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.expectation">
<code class="descname">expectation</code><span class="sig-paren">(</span><em>A</em>, <em>diag=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.expectation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the expectation value of matrix <em class="xref py py-obj">A</em></p>
<p>The expectation matrix is calculated as:</p>
<div class="math">
\[A_{ij} = \langle \psi_i | \mathbf A | \psi_j \rangle\]</div>
<p>If <em class="xref py py-obj">diag</em> is true, only the diagonal elements are returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A</strong> : array_like</p>
<blockquote>
<div><p>a vector or matrix that expresses the operator <em class="xref py py-obj">A</em></p>
</div></blockquote>
<p><strong>diag</strong> : bool, optional</p>
<blockquote>
<div><p>whether only the diagonal elements are calculated or if the full expectation
matrix is calculated</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>expectation</strong> : a vector if <em class="xref py py-obj">diag</em> is true, otherwise the expectation matrix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.info">
<code class="descname">info</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.inv_eff_mass_tensor">
<code class="descname">inv_eff_mass_tensor</code><span class="sig-paren">(</span><em>as_matrix=False</em>, <em>eps=0.001</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.inv_eff_mass_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate inverse effective mass tensor for the states</p>
<p>This routine calls <em class="xref py py-obj">inv_eff_mass</em> with appropriate arguments
and returns the state inverse effective mass tensor. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <code class="xref py py-obj docutils literal"><span class="pre">StateCElectron</span></code> <em>must</em> correspond
to the energies of the states.</p>
<p>See <code class="xref py py-obj docutils literal"><span class="pre">inv_eff_mass_tensor</span></code> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>as_matrix</strong> : bool, optional</p>
<blockquote>
<div><p>if true the returned tensor will be a symmetric matrix, otherwise the Voigt tensor is returned.</p>
</div></blockquote>
<p><strong>eps</strong> : float, optional</p>
<blockquote class="last">
<div><p>precision used to find degenerate states.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The reason for not inverting the mass-tensor is that for systems with limited
periodicities some of the diagonal elements of the inverse mass tensor matrix
will be 0, in which case the matrix is singular and non-invertible. Therefore
it is the users responsibility to remove any of the non-periodic elements from
the matrix.</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.iter">
<code class="descname">iter</code><span class="sig-paren">(</span><em>asarray=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator looping over the states in this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>asarray: bool, optional</strong></p>
<blockquote>
<div><p>if true the yielded values are the state vectors, i.e. a numpy array.
Otherwise an equivalent object is yielded.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first"><strong>state</strong> : State</p>
<blockquote>
<div><p>a state <em>only</em> containing individual elements, if <em class="xref py py-obj">asarray</em> is false</p>
</div></blockquote>
<p><strong>state</strong> : numpy.ndarray</p>
<blockquote class="last">
<div><p>a state <em>only</em> containing individual elements, if <em class="xref py py-obj">asarray</em> is true</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector with the norm of each state <span class="math">\(\sqrt{\langle\psi|\psi\rangle}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.ndarray</p>
<blockquote class="last">
<div><p>the normalization for each state</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.norm2">
<code class="descname">norm2</code><span class="sig-paren">(</span><em>sum=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.norm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector with the norm of each state <span class="math">\(\langle\psi|\psi\rangle\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sum</strong> : bool, optional</p>
<blockquote>
<div><p>if true the summed orbital square is returned (a vector). For false a matrix
with normalization squared per orbital is returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.ndarray</p>
<blockquote class="last">
<div><p>the normalization on each orbital for each state</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a normalized state where each state has <span class="math">\(|\psi|^2=1\)</span></p>
<p>This is roughly equivalent to:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">StateC</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_state</span> <span class="o">=</span> <span class="n">StateC</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">state</span> <span class="o">/</span> <span class="n">n</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_state</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>state</strong> : a new state with all states normalized, otherwise equal to this</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.occupation">
<code class="descname">occupation</code><span class="sig-paren">(</span><em>distribution='fermi_dirac'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#EigenstateElectron.occupation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.EigenstateElectron.occupation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the occupations for the states according to a distribution function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>distribution</strong> : str or func, optional</p>
<blockquote>
<div><p>distribution used to find occupations</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>numpy.ndarray</strong> : len(self) with occupation values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.outer">
<code class="descname">outer</code><span class="sig-paren">(</span><em>idx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.outer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the outer product for the indices <em class="xref py py-obj">idx</em> (or all if <code class="docutils literal"><span class="pre">None</span></code>) by <span class="math">\(\sum_i|\psi_i\rangle c_i\langle\psi_i|\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>idx</strong> : int or array_like, optional</p>
<blockquote>
<div><p>only perform an outer product of the specified indices, otherwise all states are used</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>numpy.ndarray</strong> : a matrix with the sum of outer state products</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.parent">
<code class="descname">parent</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.parent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.psi">
<code class="descname">psi</code><span class="sig-paren">(</span><em>grid</em>, <em>spinor=0</em>, <em>eta=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.psi" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></p>
<p>See <a class="reference internal" href="sisl.physics.electron.wavefunction.html#sisl.physics.electron.wavefunction" title="sisl.physics.electron.wavefunction"><code class="xref py py-obj docutils literal"><span class="pre">wavefunction</span></code></a> for argument details.</p>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.shape">
<code class="descname">shape</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shape of the state</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.sort">
<code class="descname">sort</code><span class="sig-paren">(</span><em>ascending=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort and return a new <a class="reference internal" href="sisl.physics.StateC.html#sisl.physics.StateC" title="sisl.physics.StateC"><code class="xref py py-obj docutils literal"><span class="pre">StateC</span></code></a> by sorting the coefficients (default to ascending)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ascending</strong> : bool, optional</p>
<blockquote class="last">
<div><p>sort the contained elements ascending, else they will be sorted descending</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.spin_moment">
<code class="descname">spin_moment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.spin_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spin moment from the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.spin_moment.html#sisl.physics.electron.spin_moment" title="sisl.physics.electron.spin_moment"><code class="xref py py-obj docutils literal"><span class="pre">spin_moment</span></code></a> with appropriate arguments
and returns the spin moment for the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.spin_moment.html#sisl.physics.electron.spin_moment" title="sisl.physics.electron.spin_moment"><code class="xref py py-obj docutils literal"><span class="pre">spin_moment</span></code></a> for details.</p>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.EigenstateElectron.state">
<code class="descname">state</code><a class="headerlink" href="#sisl.physics.EigenstateElectron.state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.sub">
<code class="descname">sub</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new state with only the specified states</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>idx</strong> : int or array_like</p>
<blockquote>
<div><p>indices that are retained in the returned object</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>StateC</strong> : a new object with a subset of the states</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.velocity">
<code class="descname">velocity</code><span class="sig-paren">(</span><em>eps=0.0001</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity for the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal"><span class="pre">velocity</span></code></a> with appropriate arguments
and returns the velocity for the states. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <code class="xref py py-obj docutils literal"><span class="pre">StateCElectron</span></code> <em>must</em> correspond
to the energies of the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal"><span class="pre">velocity</span></code></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eps</strong> : float, optional</p>
<blockquote class="last">
<div><p>precision used to find degenerate states.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.velocity_matrix">
<code class="descname">velocity_matrix</code><span class="sig-paren">(</span><em>eps=0.0001</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.velocity_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity matrix for the states</p>
<p>This routine calls <code class="xref py py-obj docutils literal"><span class="pre">velocity_matrix</span></code> with appropriate arguments
and returns the velocity for the states. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <code class="xref py py-obj docutils literal"><span class="pre">StateCElectron</span></code> <em>must</em> correspond
to the energies of the states.</p>
<p>See <code class="xref py py-obj docutils literal"><span class="pre">velocity_matrix</span></code> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eps</strong> : float, optional</p>
<blockquote class="last">
<div><p>precision used to find degenerate states.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.EigenstateElectron.wavefunction">
<code class="descname">wavefunction</code><span class="sig-paren">(</span><em>grid</em>, <em>spinor=0</em>, <em>eta=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.EigenstateElectron.wavefunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></p>
<p>See <a class="reference internal" href="sisl.physics.electron.wavefunction.html#sisl.physics.electron.wavefunction" title="sisl.physics.electron.wavefunction"><code class="xref py py-obj docutils literal"><span class="pre">wavefunction</span></code></a> for argument details.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sisl.physics.phonon.DOS.html" class="btn btn-neutral float-right" title="DOS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sisl.physics.EigenvectorElectron.html" class="btn btn-neutral" title="EigenvectorElectron" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, Nick R. Papior.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'latest',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>