

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>StateCElectron &mdash; sisl |release| documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> sisl
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
</ul>
<p class="caption"><span class="caption-text">Publications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using sisl</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst/files.html">File formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>StateCElectron</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api-generated/sisl.physics.electron.StateCElectron.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="statecelectron">
<h1>StateCElectron<a class="headerlink" href="#statecelectron" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="sisl.physics.electron.StateCElectron">
<em class="property">class </em><code class="sig-prename descclassname">sisl.physics.electron.</code><code class="sig-name descname">StateCElectron</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">parent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">info</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sisl.physics.electron._electron_State</span></code>, <a class="reference internal" href="sisl.physics.StateC.html#sisl.physics.StateC" title="sisl.physics.StateC"><code class="xref py py-class docutils literal notranslate"><span class="pre">sisl.physics.StateC</span></code></a></p>
<p>A state describing a physical quantity related to electrons, with associated coefficients of the state</p>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__doc__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__module__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__slots__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.c" title="sisl.physics.electron.StateCElectron.c"><code class="xref py py-obj docutils literal notranslate"><span class="pre">c</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.dkind" title="sisl.physics.electron.StateCElectron.dkind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dkind</span></code></a></p></td>
<td><p>The data-type of the state (in str)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.dtype" title="sisl.physics.electron.StateCElectron.dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></a></p></td>
<td><p>Data-type for the state</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.info" title="sisl.physics.electron.StateCElectron.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.parent" title="sisl.physics.electron.StateCElectron.parent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parent</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.shape" title="sisl.physics.electron.StateCElectron.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></p></td>
<td><p>Returns the shape of the state</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.state" title="sisl.physics.electron.StateCElectron.state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.Sk" title="sisl.physics.electron.StateCElectron.Sk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sk</span></code></a>([format, spin])</p></td>
<td><p>Retrieve the overlap matrix corresponding to the originating parent structure.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__delattr__</span></code>(name, /)</p></td>
<td><p>Implement delattr(self, name).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dir__</span></code>()</p></td>
<td><p>Default dir() implementation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__eq__</span></code>(value, /)</p></td>
<td><p>Return self==value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__format__</span></code>(format_spec, /)</p></td>
<td><p>Default object formatter.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ge__</span></code>(value, /)</p></td>
<td><p>Return self&gt;=value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattribute__</span></code>(name, /)</p></td>
<td><p>Return getattr(self, name).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getitem__</span></code>(key)</p></td>
<td><p>Return a new state with only one associated state</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__gt__</span></code>(value, /)</p></td>
<td><p>Return self&gt;value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__hash__</span></code>()</p></td>
<td><p>Return hash(self).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>(state, c[, parent])</p></td>
<td><p>Define a state container with a given set of states and coefficients for the states</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init_subclass__</span></code></p></td>
<td><p>This method is called when a class is subclassed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__iter__</span></code>([asarray])</p></td>
<td><p>An iterator looping over the states in this system</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__le__</span></code>(value, /)</p></td>
<td><p>Return self&lt;=value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__len__</span></code>()</p></td>
<td><p>Number of states</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__lt__</span></code>(value, /)</p></td>
<td><p>Return self&lt;value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ne__</span></code>(value, /)</p></td>
<td><p>Return self!=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__new__</span></code>(**kwargs)</p></td>
<td><p>Create and return a new object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce__</span></code>()</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce_ex__</span></code>(protocol, /)</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code>()</p></td>
<td><p>Return repr(self).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__setattr__</span></code>(name, value, /)</p></td>
<td><p>Implement setattr(self, name, value).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__sizeof__</span></code>()</p></td>
<td><p>Size of object in memory, in bytes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__str__</span></code>()</p></td>
<td><p>The string representation of this object</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__subclasshook__</span></code></p></td>
<td><p>Abstract classes can override this to customize issubclass().</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_electron_State__is_nc</span></code>()</p></td>
<td><p>Internal routine to check whether this is a non-colinear calculation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_sanitize_index</span></code>(idx)</p></td>
<td><p>Ensure indices are transferred to acceptable integers</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.align_norm" title="sisl.physics.electron.StateCElectron.align_norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">align_norm</span></code></a>(other[, ret_index])</p></td>
<td><p>Align <em class="xref py py-obj">other.state</em> with the site-norms for this state, a copy of <em class="xref py py-obj">other</em> is returned with re-ordered states</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.align_phase" title="sisl.physics.electron.StateCElectron.align_phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">align_phase</span></code></a>(other[, copy])</p></td>
<td><p>Align <em class="xref py py-obj">other.state</em> with the phases for this state, a copy of <em class="xref py py-obj">other</em> is returned with rotated elements</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.asCoefficient" title="sisl.physics.electron.StateCElectron.asCoefficient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asCoefficient</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.asState" title="sisl.physics.electron.StateCElectron.asState"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asState</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.berry_curvature" title="sisl.physics.electron.StateCElectron.berry_curvature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_curvature</span></code></a>([complex, eps])</p></td>
<td><p>Calculate Berry curvature for the states</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.change_gauge" title="sisl.physics.electron.StateCElectron.change_gauge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">change_gauge</span></code></a>(gauge)</p></td>
<td><p>In-place change of the gauge of the state coefficients</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.copy" title="sisl.physics.electron.StateCElectron.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a copy (only the coefficients and states are copied), <code class="docutils literal notranslate"><span class="pre">parent</span></code> and <code class="docutils literal notranslate"><span class="pre">info</span></code> are passed by reference</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.degenerate" title="sisl.physics.electron.StateCElectron.degenerate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">degenerate</span></code></a>(eps)</p></td>
<td><p>Find degenerate coefficients with a specified precision</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.expectation" title="sisl.physics.electron.StateCElectron.expectation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expectation</span></code></a>(A[, diag])</p></td>
<td><p>Calculate the expectation value of matrix <em class="xref py py-obj">A</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.inner" title="sisl.physics.electron.StateCElectron.inner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inner</span></code></a>([right, diagonal, align])</p></td>
<td><p>Return the inner product by <span class="math notranslate nohighlight">\(\mathbf M_{ij} = \langle\psi_i|\psi'_j\rangle\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.inv_eff_mass_tensor" title="sisl.physics.electron.StateCElectron.inv_eff_mass_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inv_eff_mass_tensor</span></code></a>([as_matrix, eps])</p></td>
<td><p>Calculate inverse effective mass tensor for the states</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.iter" title="sisl.physics.electron.StateCElectron.iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter</span></code></a>([asarray])</p></td>
<td><p>An iterator looping over the states in this system</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.norm" title="sisl.physics.electron.StateCElectron.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a>()</p></td>
<td><p>Return a vector with the Euclidean norm of each state <span class="math notranslate nohighlight">\(\sqrt{\langle\psi|\psi\rangle}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.norm2" title="sisl.physics.electron.StateCElectron.norm2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm2</span></code></a>([sum])</p></td>
<td><p>Return a vector with the norm of each state <span class="math notranslate nohighlight">\(\langle\psi|\mathbf S|\psi\rangle\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.normalize" title="sisl.physics.electron.StateCElectron.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>()</p></td>
<td><p>Return a normalized state where each state has <span class="math notranslate nohighlight">\(|\psi|^2=1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.outer" title="sisl.physics.electron.StateCElectron.outer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">outer</span></code></a>([idx])</p></td>
<td><p>Return the outer product for the indices <em class="xref py py-obj">idx</em> (or all if <code class="docutils literal notranslate"><span class="pre">None</span></code>) by <span class="math notranslate nohighlight">\(\sum_i|\psi_i\rangle c_i\langle\psi_i|\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.phase" title="sisl.physics.electron.StateCElectron.phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phase</span></code></a>([method, return_indices])</p></td>
<td><p>Calculate the Euler angle (phase) for the elements of the state, in the range <span class="math notranslate nohighlight">\(]-\pi;\pi]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.rotate" title="sisl.physics.electron.StateCElectron.rotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotate</span></code></a>([phi, individual])</p></td>
<td><p>Rotate all states (in-place) to rotate the largest component to be along the angle <em class="xref py py-obj">phi</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.sort" title="sisl.physics.electron.StateCElectron.sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort</span></code></a>([ascending])</p></td>
<td><p>Sort and return a new <code class="xref py py-obj docutils literal notranslate"><span class="pre">StateC</span></code> by sorting the coefficients (default to ascending)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.spin_moment" title="sisl.physics.electron.StateCElectron.spin_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spin_moment</span></code></a>([project])</p></td>
<td><p>Calculate spin moment from the states</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.sub" title="sisl.physics.electron.StateCElectron.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code></a>(idx)</p></td>
<td><p>Return a new state with only the specified states</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.velocity" title="sisl.physics.electron.StateCElectron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a>([eps, project])</p></td>
<td><p>Calculate velocity for the states</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.velocity_matrix" title="sisl.physics.electron.StateCElectron.velocity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_matrix</span></code></a>([eps])</p></td>
<td><p>Calculate velocity matrix for the states</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.physics.electron.StateCElectron.wavefunction" title="sisl.physics.electron.StateCElectron.wavefunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavefunction</span></code></a>(grid[, spinor, eta])</p></td>
<td><p>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.Sk">
<code class="sig-name descname">Sk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">'csr'</span></em>, <em class="sig-param"><span class="n">spin</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.Sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the overlap matrix corresponding to the originating parent structure.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">self.parent</span></code> is a Hamiltonian this will return <span class="math notranslate nohighlight">\(\mathbf S(k)\)</span> for the
<span class="math notranslate nohighlight">\(k\)</span>-point these eigenstates originate from</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – the returned format of the overlap matrix. This only takes effect for
non-orthogonal parents.</p></li>
<li><p><strong>spin</strong> (<a class="reference internal" href="sisl.physics.Spin.html#sisl.physics.Spin" title="sisl.physics.Spin"><em>Spin</em></a><em>, </em><em>optional</em>) – for non-colinear spin configurations the <em>fake</em> overlap matrix returned
will have halve the size of the input matrix. If you want the <em>full</em> overlap
matrix, simply do not specify the <em class="xref py py-obj">spin</em> argument.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.align_norm">
<code class="sig-name descname">align_norm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em>, <em class="sig-param"><span class="n">ret_index</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.align_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Align <em class="xref py py-obj">other.state</em> with the site-norms for this state, a copy of <em class="xref py py-obj">other</em> is returned with re-ordered states</p>
<p>To determine the new ordering of <em class="xref py py-obj">other</em> we first calculate the residual norm of the site-norms.</p>
<div class="math notranslate nohighlight">
\[\delta N_{\alpha\beta} = \sum_i \big(\langle \psi^\alpha_i | \psi^\alpha_i\rangle - \langle \psi^\beta_i | \psi^\beta_i\rangle\big)^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> correspond to state indices in <em class="xref py py-obj">self</em> and <em class="xref py py-obj">other</em>, respectively.
The new states (from <em class="xref py py-obj">other</em>) returned is then ordered such that the index
<span class="math notranslate nohighlight">\(\alpha \equiv \beta'\)</span> where <span class="math notranslate nohighlight">\(\delta N_{\alpha\beta}\)</span> is smallest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="sisl.physics.State.html#sisl.physics.State" title="sisl.physics.State"><em>State</em></a>) – the other state to align onto this state</p></li>
<li><p><strong>ret_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – also return indices for the swapped indices</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>other_swap</strong> (<em>State</em>) – A swapped instance of <em class="xref py py-obj">other</em></p></li>
<li><p><strong>index</strong> (<em>array of int</em>) – the indices that swaps <em class="xref py py-obj">other</em> to be <code class="docutils literal notranslate"><span class="pre">other_swap</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">other_swap</span> <span class="pre">=</span> <span class="pre">other.sub(index)</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The input state and output state have the same states, but their ordering is not necessarily the same.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.physics.electron.StateCElectron.align_phase" title="sisl.physics.electron.StateCElectron.align_phase"><code class="xref py py-meth docutils literal notranslate"><span class="pre">align_phase</span></code></a></dt><dd><p>rotate states such that their phases align</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.align_phase">
<code class="sig-name descname">align_phase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.align_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Align <em class="xref py py-obj">other.state</em> with the phases for this state, a copy of <em class="xref py py-obj">other</em> is returned with rotated elements</p>
<p>States will be rotated by <span class="math notranslate nohighlight">\(\pi\)</span> provided the phase difference between the states are above <span class="math notranslate nohighlight">\(|\Delta\theta| &gt; \pi/2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="sisl.physics.State.html#sisl.physics.State" title="sisl.physics.State"><em>State</em></a>) – the other state to align onto this state</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – sometimes no states require rotation, if this is the case this flag determines whether <em class="xref py py-obj">other</em> will be
copied or not</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.physics.electron.StateCElectron.align_norm" title="sisl.physics.electron.StateCElectron.align_norm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">align_norm</span></code></a></dt><dd><p>re-order states such that site-norms have a smaller residual</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.asCoefficient">
<code class="sig-name descname">asCoefficient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.asCoefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.asState">
<code class="sig-name descname">asState</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.asState" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.berry_curvature">
<code class="sig-name descname">berry_curvature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">complex</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">0.0001</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.berry_curvature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.berry_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Berry curvature for the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.berry_curvature.html#sisl.physics.electron.berry_curvature" title="sisl.physics.electron.berry_curvature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_curvature</span></code></a> with appropriate arguments
and returns the Berry curvature for the states.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.berry_curvature.html#sisl.physics.electron.berry_curvature" title="sisl.physics.electron.berry_curvature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_curvature</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>complex</strong> (<em>logical</em><em>, </em><em>optional</em>) – whether the returned quantity is complex valued</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – precision used to find degenerate states.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sisl.physics.electron.StateCElectron.c">
<code class="sig-name descname">c</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.change_gauge">
<code class="sig-name descname">change_gauge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gauge</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.change_gauge" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place change of the gauge of the state coefficients</p>
<p>The two gauges are related through:</p>
<div class="math notranslate nohighlight">
\[\tilde C_j = e^{i\mathbf k\mathbf r_j} C_j\]</div>
<p>where <span class="math notranslate nohighlight">\(C_j\)</span> belongs to the gauge <code class="docutils literal notranslate"><span class="pre">R</span></code> and <span class="math notranslate nohighlight">\(\tilde C_j\)</span> is in the gauge
<code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gauge</strong> (<em>{'R'</em><em>, </em><em>'r'}</em>) – specify the new gauge for the state coefficients</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy (only the coefficients and states are copied), <code class="docutils literal notranslate"><span class="pre">parent</span></code> and <code class="docutils literal notranslate"><span class="pre">info</span></code> are passed by reference</p>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.degenerate">
<code class="sig-name descname">degenerate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eps</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.degenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Find degenerate coefficients with a specified precision</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the precision above which coefficients are not considered degenerate</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of indices</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.dkind">
<em class="property">property </em><code class="sig-name descname">dkind</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.dkind" title="Permalink to this definition">¶</a></dt>
<dd><p>The data-type of the state (in str)</p>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.dtype">
<em class="property">property </em><code class="sig-name descname">dtype</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Data-type for the state</p>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.expectation">
<code class="sig-name descname">expectation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">diag</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.expectation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the expectation value of matrix <em class="xref py py-obj">A</em></p>
<p>The expectation matrix is calculated as:</p>
<div class="math notranslate nohighlight">
\[A_{ij} = \langle \psi_i | \mathbf A | \psi_j \rangle\]</div>
<p>If <em class="xref py py-obj">diag</em> is true, only the diagonal elements are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>array_like</em>) – a vector or matrix that expresses the operator <em class="xref py py-obj">A</em></p></li>
<li><p><strong>diag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – whether only the diagonal elements are calculated or if the full expectation
matrix is calculated</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a vector if <em class="xref py py-obj">diag</em> is true, otherwise a matrix with expectation values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sisl.physics.electron.StateCElectron.info">
<code class="sig-name descname">info</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.inner">
<code class="sig-name descname">inner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">right</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">diagonal</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">align</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.inner" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inner product by <span class="math notranslate nohighlight">\(\mathbf M_{ij} = \langle\psi_i|\psi'_j\rangle\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> (<a class="reference internal" href="sisl.physics.State.html#sisl.physics.State" title="sisl.physics.State"><em>State</em></a><em>, </em><em>optional</em>) – the right object to calculate the inner product with, if not passed it will do the inner
product with itself. This object will always be the left <span class="math notranslate nohighlight">\(\langle\psi_i|\)</span>.</p></li>
<li><p><strong>diagonal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – only return the diagonal matrix <span class="math notranslate nohighlight">\(\mathbf M_{ii}\)</span>.</p></li>
<li><p><strong>align</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – first align <em class="xref py py-obj">right</em> with the angles for this state (see <em class="xref py py-obj">align</em>)</p></li>
</ul>
</dd>
</dl>
<p>:raises ValueError : in case where <em class="xref py py-obj">right</em> is not None and <em class="xref py py-obj">self</em> and <em class="xref py py-obj">right</em> has differing overlap matrix.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix with the sum of inner state products</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.inv_eff_mass_tensor">
<code class="sig-name descname">inv_eff_mass_tensor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">as_matrix</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.inv_eff_mass_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.inv_eff_mass_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate inverse effective mass tensor for the states</p>
<p>This routine calls <em class="xref py py-obj">inv_eff_mass</em> with appropriate arguments
and returns the state inverse effective mass tensor. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <code class="xref py py-obj docutils literal notranslate"><span class="pre">inv_eff_mass_tensor</span></code> for details.</p>
<p class="rubric">Notes</p>
<p>The reason for not inverting the mass-tensor is that for systems with limited
periodicities some of the diagonal elements of the inverse mass tensor matrix
will be 0, in which case the matrix is singular and non-invertible. Therefore
it is the users responsibility to remove any of the non-periodic elements from
the matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>as_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – if true the returned tensor will be a symmetric matrix, otherwise the Voigt tensor is returned.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – precision used to find degenerate states.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.iter">
<code class="sig-name descname">iter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">asarray</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator looping over the states in this system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>asarray</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – if true the yielded values are the state vectors, i.e. a numpy array.
Otherwise an equivalent object is yielded.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>state</strong> (<em>State</em>) – a state <em>only</em> containing individual elements, if <em class="xref py py-obj">asarray</em> is false</p></li>
<li><p><strong>state</strong> (<em>numpy.ndarray</em>) – a state <em>only</em> containing individual elements, if <em class="xref py py-obj">asarray</em> is true</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.norm">
<code class="sig-name descname">norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector with the Euclidean norm of each state <span class="math notranslate nohighlight">\(\sqrt{\langle\psi|\psi\rangle}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the Euclidean norm for each state</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.norm2">
<code class="sig-name descname">norm2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sum</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.norm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector with the norm of each state <span class="math notranslate nohighlight">\(\langle\psi|\mathbf S|\psi\rangle\)</span></p>
<p><span class="math notranslate nohighlight">\(\mathbf S\)</span> is the overlap matrix (or basis), for orthogonal basis
<span class="math notranslate nohighlight">\(\mathbf S \equiv \mathbf I\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – for true only a single number per state will be returned, otherwise the norm
per basis element will be returned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the squared norm for each state</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a normalized state where each state has <span class="math notranslate nohighlight">\(|\psi|^2=1\)</span></p>
<p>This is roughly equivalent to:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">StateC</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_state</span> <span class="o">=</span> <span class="n">StateC</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">state</span> <span class="o">/</span> <span class="n">n</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_state</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new state with all states normalized, otherwise equal to this</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="sisl.physics.State.html#sisl.physics.State" title="sisl.physics.State">State</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.outer">
<code class="sig-name descname">outer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.outer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the outer product for the indices <em class="xref py py-obj">idx</em> (or all if <code class="docutils literal notranslate"><span class="pre">None</span></code>) by <span class="math notranslate nohighlight">\(\sum_i|\psi_i\rangle c_i\langle\psi_i|\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – only perform an outer product of the specified indices, otherwise all states are used</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a matrix with the sum of outer state products</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sisl.physics.electron.StateCElectron.parent">
<code class="sig-name descname">parent</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.parent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.phase">
<code class="sig-name descname">phase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">return_indices</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Euler angle (phase) for the elements of the state, in the range <span class="math notranslate nohighlight">\(]-\pi;\pi]\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{'max'</em><em>, </em><em>'all'}</em>) – for max, the phase for the element which has the largest absolute magnitude is returned,
for all, all phases are calculated</p></li>
<li><p><strong>return_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – return indices for the elements used when <code class="docutils literal notranslate"><span class="pre">method=='max'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phi</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">individual</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate all states (in-place) to rotate the largest component to be along the angle <em class="xref py py-obj">phi</em></p>
<p>The states will be rotated according to:</p>
<div class="math notranslate nohighlight">
\[S' = S / S^\dagger_{\phi-\mathrm{max}} \exp (i \phi),\]</div>
<p>where <span class="math notranslate nohighlight">\(S^\dagger_{\phi-\mathrm{max}}\)</span> is the phase of the component with the largest amplitude
and <span class="math notranslate nohighlight">\(\phi\)</span> is the angle to align on.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – angle to align the state at (in radians), 0 is the positive real axis</p></li>
<li><p><strong>individual</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – whether the rotation is per state, or a single maximum component is chosen.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shape of the state</p>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.sort">
<code class="sig-name descname">sort</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ascending</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort and return a new <code class="xref py py-obj docutils literal notranslate"><span class="pre">StateC</span></code> by sorting the coefficients (default to ascending)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ascending</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – sort the contained elements ascending, else they will be sorted descending</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.spin_moment">
<code class="sig-name descname">spin_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">project</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.spin_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spin moment from the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.spin_moment.html#sisl.physics.electron.spin_moment" title="sisl.physics.electron.spin_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spin_moment</span></code></a> with appropriate arguments
and returns the spin moment for the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.spin_moment.html#sisl.physics.electron.spin_moment" title="sisl.physics.electron.spin_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spin_moment</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>project</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – whether the moments are orbitally resolved or not</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sisl.physics.electron.StateCElectron.state">
<code class="sig-name descname">state</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.sub">
<code class="sig-name descname">sub</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new state with only the specified states</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><em>array_like</em>) – indices that are retained in the returned object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new object with a subset of the states</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="sisl.physics.StateC.html#sisl.physics.StateC" title="sisl.physics.StateC">StateC</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.velocity">
<code class="sig-name descname">velocity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">0.0001</span></em>, <em class="sig-param"><span class="n">project</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity for the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a> with appropriate arguments
and returns the velocity for the states. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – precision used to find degenerate states.</p></li>
<li><p><strong>project</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to return projected velocities (per orbital), see <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a> for details</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="sisl.physics.electron.PDOS.html#sisl.physics.electron.PDOS" title="sisl.physics.electron.PDOS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PDOS</span></code></a></dt><dd><p>for an explanation of the projections in case of <em class="xref py py-obj">project</em> being True</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.velocity_matrix">
<code class="sig-name descname">velocity_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">0.0001</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.velocity_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.velocity_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity matrix for the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.velocity_matrix.html#sisl.physics.electron.velocity_matrix" title="sisl.physics.electron.velocity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_matrix</span></code></a> with appropriate arguments
and returns the velocity for the states. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.velocity_matrix.html#sisl.physics.electron.velocity_matrix" title="sisl.physics.electron.velocity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_matrix</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – precision used to find degenerate states.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.physics.electron.StateCElectron.wavefunction">
<code class="sig-name descname">wavefunction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">grid</span></em>, <em class="sig-param"><span class="n">spinor</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">eta</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.wavefunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></p>
<p>See <a class="reference internal" href="sisl.physics.electron.wavefunction.html#sisl.physics.electron.wavefunction" title="sisl.physics.electron.wavefunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavefunction</span></code></a> for argument details, the arguments not present
in this method are automatically passed from this object.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2020, Nick Papior

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>