

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tsgfSileSiesta &mdash; sisl |release| documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tsvncSileSiesta" href="sisl.io.siesta.tsvncSileSiesta.html" />
    <link rel="prev" title="tsdeSileSiesta" href="sisl.io.siesta.tsdeSileSiesta.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> sisl
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
</ul>
<p class="caption"><span class="caption-text">Publications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using sisl</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Command line scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst/files.html">File formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Toolboxes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../toolbox/toolbox.html">Toolboxes</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api.html">API documentation</a> &raquo;</li>
        
          <li><a href="sisl.io.html">Input/Output (<code class="xref py py-mod docutils literal notranslate"><span class="pre">sisl.io</span></code>)</a> &raquo;</li>
        
      <li>tsgfSileSiesta</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api-generated/sisl.io.siesta.tsgfSileSiesta.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="tsgfsilesiesta">
<h1>tsgfSileSiesta<a class="headerlink" href="#tsgfsilesiesta" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="sisl.io.siesta.tsgfSileSiesta">
<em class="property">class </em><code class="sig-prename descclassname">sisl.io.siesta.</code><code class="sig-name descname">tsgfSileSiesta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sisl.io.siesta._gfSileSiesta</span></code></p>
<p>Surface Green function file containing, Hamiltonian, overlap matrix and self-energies</p>
<p>Do not mix read and write statements when using this code. Complete one or the other
before doing the other thing. Fortran does not allow the same file opened twice, if this
is needed you are recommended to make a symlink to the file and thus open two different
files.</p>
<p>This small snippet reads/writes the GF file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">sisl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tsgfSileSiesta</span><span class="p">(</span><span class="s1">&#39;hello.GF&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">nspin</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read_header</span><span class="p">()</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">ispin</span><span class="p">,</span> <span class="n">new_k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>       <span class="k">if</span> <span class="n">new_k</span><span class="p">:</span>
<span class="gp">... </span>           <span class="n">H</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read_hamiltonian</span><span class="p">()</span>
<span class="gp">... </span>       <span class="n">SeHSE</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read_self_energy</span><span class="p">()</span>
</pre></div>
</div>
<p>To write a file do:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">sisl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">tsgfSileSiesta</span><span class="p">(</span><span class="s1">&#39;hello.GF&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">f</span><span class="o">.</span><span class="n">write_header</span><span class="p">(</span><span class="n">sisl</span><span class="o">.</span><span class="n">MonkhorstPack</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="n">E</span><span class="p">)</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">ispin</span><span class="p">,</span> <span class="n">new_k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>       <span class="k">if</span> <span class="n">new_k</span><span class="p">:</span>
<span class="gp">... </span>           <span class="n">f</span><span class="o">.</span><span class="n">write_hamiltonian</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">f</span><span class="o">.</span><span class="n">write_self_energy</span><span class="p">(</span><span class="n">SeHSE</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dict__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__doc__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__module__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__weakref__</span></code></p></td>
<td><p>list of weak references to the object (if defined)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_write_default</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_write_default_only</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.base_file" title="sisl.io.siesta.tsgfSileSiesta.base_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_file</span></code></a></p></td>
<td><p>File of the current <em class="xref py py-obj">Sile</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.file" title="sisl.io.siesta.tsgfSileSiesta.file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">file</span></code></a></p></td>
<td><p>File of the current <em class="xref py py-obj">Sile</em></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.Eindex" title="sisl.io.siesta.tsgfSileSiesta.Eindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Eindex</span></code></a>(E)</p></td>
<td><p>Return the closest energy index corresponding to the energy <code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.HkSk" title="sisl.io.siesta.tsgfSileSiesta.HkSk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HkSk</span></code></a>([k, spin])</p></td>
<td><p>Retrieve H and S for the given k-point</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_ArgumentParser_args_single</span></code>()</p></td>
<td><p>Default arguments for the Sile</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__delattr__</span></code>(name, /)</p></td>
<td><p>Implement delattr(self, name).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dir__</span></code>()</p></td>
<td><p>Default dir() implementation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__enter__</span></code>()</p></td>
<td><p>Opens the output file and returns it self</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__eq__</span></code>(value, /)</p></td>
<td><p>Return self==value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__exit__</span></code>(type, value, traceback)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__format__</span></code>(format_spec, /)</p></td>
<td><p>Default object formatter.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ge__</span></code>(value, /)</p></td>
<td><p>Return self&gt;=value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattr__</span></code>(name)</p></td>
<td><p>Override to check the handle</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattribute__</span></code>(name, /)</p></td>
<td><p>Return getattr(self, name).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__gt__</span></code>(value, /)</p></td>
<td><p>Return self&gt;value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__hash__</span></code>()</p></td>
<td><p>Return hash(self).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>(filename[, mode])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init_subclass__</span></code></p></td>
<td><p>This method is called when a class is subclassed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__iter__</span></code>()</p></td>
<td><p>Iterate through the energies and k-points that this GF file is associated with</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__le__</span></code>(value, /)</p></td>
<td><p>Return self&lt;=value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__len__</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__lt__</span></code>(value, /)</p></td>
<td><p>Return self&lt;value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ne__</span></code>(value, /)</p></td>
<td><p>Return self!=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__new__</span></code>(**kwargs)</p></td>
<td><p>Create and return a new object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce__</span></code>()</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce_ex__</span></code>(protocol, /)</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code>()</p></td>
<td><p>Return repr(self).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__setattr__</span></code>(name, value, /)</p></td>
<td><p>Implement setattr(self, name, value).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__sizeof__</span></code>()</p></td>
<td><p>Size of object in memory, in bytes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__str__</span></code>()</p></td>
<td><p>Return a representation of the <em class="xref py py-obj">Sile</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__subclasshook__</span></code></p></td>
<td><p>Abstract classes can override this to customize issubclass().</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_base_file</span></code>(f)</p></td>
<td><p>Make <em class="xref py py-obj">f</em> refer to the file with the appropriate base directory</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_base_setup</span></code>(*args, **kwargs)</p></td>
<td><p>Setup the <em class="xref py py-obj">Sile</em> after initialization</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_close_gf</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_is_open</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_open_gf</span></code>(mode[, rewind])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_setup</span></code>(*args, **kwargs)</p></td>
<td><p>Simple setup that needs to be overwritten</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_step_counter</span></code>(method, **kwargs)</p></td>
<td><p>Method for stepping values <em>must</em> be called before doing the actual read to check correct values</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.dir_file" title="sisl.io.siesta.tsgfSileSiesta.dir_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dir_file</span></code></a>([filename])</p></td>
<td><p>File of the current <em class="xref py py-obj">Sile</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.disk_usage" title="sisl.io.siesta.tsgfSileSiesta.disk_usage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disk_usage</span></code></a>()</p></td>
<td><p>Calculate the estimated size of the resulting file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.exist" title="sisl.io.siesta.tsgfSileSiesta.exist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exist</span></code></a>()</p></td>
<td><p>Query whether the file exists</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.kindex" title="sisl.io.siesta.tsgfSileSiesta.kindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kindex</span></code></a>(k)</p></td>
<td><p>Return the index of the k-point that is closests to the queried k-point (in reduced coordinates)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.read" title="sisl.io.siesta.tsgfSileSiesta.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(*args, **kwargs)</p></td>
<td><p>Generic read method which should be overloaded in child-classes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.read_hamiltonian" title="sisl.io.siesta.tsgfSileSiesta.read_hamiltonian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_hamiltonian</span></code></a>()</p></td>
<td><p>Return current Hamiltonian and overlap matrix from the GF file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.read_header" title="sisl.io.siesta.tsgfSileSiesta.read_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_header</span></code></a>()</p></td>
<td><p>Read the header of the file and open it for reading subsequently</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.read_self_energy" title="sisl.io.siesta.tsgfSileSiesta.read_self_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_self_energy</span></code></a>()</p></td>
<td><p>Read the currently reached bulk self-energy</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.self_energy" title="sisl.io.siesta.tsgfSileSiesta.self_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">self_energy</span></code></a>(E[, k, spin])</p></td>
<td><p>Retrieve self-energy for a given energy-point and k-point</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.write" title="sisl.io.siesta.tsgfSileSiesta.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(*args, **kwargs)</p></td>
<td><p>Generic write method which should be overloaded in child-classes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.write_hamiltonian" title="sisl.io.siesta.tsgfSileSiesta.write_hamiltonian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_hamiltonian</span></code></a>(H[, S])</p></td>
<td><p>Write the current energy, k-point and H and S to the file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.write_header" title="sisl.io.siesta.tsgfSileSiesta.write_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_header</span></code></a>(bz, E[, mu, obj])</p></td>
<td><p>Write to the binary file the header of the file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.write_self_energy" title="sisl.io.siesta.tsgfSileSiesta.write_self_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_self_energy</span></code></a>(SE)</p></td>
<td><p>Write the current self energy, k-point and H and S to the file</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.Eindex">
<code class="sig-name descname">Eindex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.Eindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the closest energy index corresponding to the energy <code class="docutils literal notranslate"><span class="pre">E</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – if <code class="docutils literal notranslate"><span class="pre">int</span></code>, return it-self, else return the energy index which is
closests to the energy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.HkSk">
<code class="sig-name descname">HkSk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">0, 0, 0</span></em>, <em class="sig-param"><span class="n">spin</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.HkSk" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve H and S for the given k-point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><em>array_like of float</em><em>, </em><em>optional</em>) – k-point to read the corresponding Hamiltonian and overlap matrices
for. If a specific k-point is passed <a class="reference internal" href="#sisl.io.siesta.tsgfSileSiesta.kindex" title="sisl.io.siesta.tsgfSileSiesta.kindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kindex</span></code></a> will be used to find
the corresponding index.</p></li>
<li><p><strong>spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – spin-index for the Hamiltonian and overlap matrices</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.base_file">
<em class="property">property </em><code class="sig-name descname">base_file</code><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.base_file" title="Permalink to this definition">¶</a></dt>
<dd><p>File of the current <em class="xref py py-obj">Sile</em></p>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.dir_file">
<code class="sig-name descname">dir_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.dir_file" title="Permalink to this definition">¶</a></dt>
<dd><p>File of the current <em class="xref py py-obj">Sile</em></p>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.disk_usage">
<code class="sig-name descname">disk_usage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.disk_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the estimated size of the resulting file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>estimated disk-space used in GB</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.exist">
<code class="sig-name descname">exist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.exist" title="Permalink to this definition">¶</a></dt>
<dd><p>Query whether the file exists</p>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.file">
<em class="property">property </em><code class="sig-name descname">file</code><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.file" title="Permalink to this definition">¶</a></dt>
<dd><p>File of the current <em class="xref py py-obj">Sile</em></p>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.kindex">
<code class="sig-name descname">kindex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.kindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the k-point that is closests to the queried k-point (in reduced coordinates)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>k</strong> (<em>array_like of float</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the queried k-point in reduced coordinates <span class="math notranslate nohighlight">\(]-0.5;0.5]\)</span>. If <code class="docutils literal notranslate"><span class="pre">int</span></code>
return it-self.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic read method which should be overloaded in child-classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – keyword arguments will try and search for the attribute <code class="docutils literal notranslate"><span class="pre">read_&lt;&gt;</span></code>
and call it with the remaining <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> as arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.read_hamiltonian">
<code class="sig-name descname">read_hamiltonian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.read_hamiltonian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current Hamiltonian and overlap matrix from the GF file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>complex128</strong> (<em>Hamiltonian matrix</em>)</p></li>
<li><p><strong>complex128</strong> (<em>Overlap matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.read_header">
<code class="sig-name descname">read_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.read_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the header of the file and open it for reading subsequently</p>
<p>NOTES: this method may change in the future</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>nspin</strong> (<em>number of spin-components stored (1 or 2)</em>)</p></li>
<li><p><strong>no_u</strong> (<em>size of the matrices returned</em>)</p></li>
<li><p><strong>k</strong> (<em>k points in the GF file</em>)</p></li>
<li><p><strong>E</strong> (<em>energy points in the GF file</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.read_self_energy">
<code class="sig-name descname">read_self_energy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.read_self_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the currently reached bulk self-energy</p>
<p>The returned self-energy is:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol \Sigma_{\mathrm{bulk}}(E) = \mathbf S E - \mathbf H - \boldsymbol \Sigma(E)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>complex128</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Self-energy matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.self_energy">
<code class="sig-name descname">self_energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E</span></em>, <em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">spin</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.self_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve self-energy for a given energy-point and k-point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – energy to retrieve self-energy at</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><em>array_like of float</em><em>, </em><em>optional</em>) – k-point to retrieve k-point at</p></li>
<li><p><strong>spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – spin-index to retrieve self-energy at</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic write method which should be overloaded in child-classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – keyword arguments will try and search for the attribute <em class="xref py py-obj">write_</em>
and call it with the remaining <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> as arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.write_hamiltonian">
<code class="sig-name descname">write_hamiltonian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">H</span></em>, <em class="sig-param"><span class="n">S</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.write_hamiltonian" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the current energy, k-point and H and S to the file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>matrix</em>) – a square matrix corresponding to the Hamiltonian</p></li>
<li><p><strong>S</strong> (<em>matrix</em><em>, </em><em>optional</em>) – a square matrix corresponding to the overlap, for efficiency reasons
it may be advantageous to specify this argument for orthogonal cells.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.write_header">
<code class="sig-name descname">write_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bz</span></em>, <em class="sig-param"><span class="n">E</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">obj</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.write_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to the binary file the header of the file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bz</strong> (<a class="reference internal" href="sisl.physics.BrillouinZone.html#sisl.physics.BrillouinZone" title="sisl.physics.BrillouinZone"><em>BrillouinZone</em></a>) – contains the k-points, the weights and possibly the parent Hamiltonian (if <em class="xref py py-obj">obj</em> is None)s</p></li>
<li><p><strong>E</strong> (<em>array_like of cmplx</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the energy points. If <em class="xref py py-obj">obj</em> is an instance of <em class="xref py py-obj">SelfEnergy</em> where an
associated <code class="docutils literal notranslate"><span class="pre">eta</span></code> is defined then <em class="xref py py-obj">E</em> may be float, otherwise
it <em>has</em> to be a complex array.</p></li>
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – chemical potential in the file</p></li>
<li><p><strong>obj</strong> (<em>..</em><em>, </em><em>optional</em>) – an object that contains the Hamiltonian definitions, defaults to <code class="docutils literal notranslate"><span class="pre">bz.parent</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sisl.io.siesta.tsgfSileSiesta.write_self_energy">
<code class="sig-name descname">write_self_energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SE</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.siesta.tsgfSileSiesta.write_self_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the current self energy, k-point and H and S to the file</p>
<p>The self-energy must correspond to the <em>bulk</em> self-energy</p>
<div class="math notranslate nohighlight">
\[\boldsymbol \Sigma_{\mathrm{bulk}}(E) = \mathbf S E - \mathbf H - \boldsymbol \Sigma(E)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>SE</strong> (<em>matrix</em>) – a square matrix corresponding to the self-energy (Green function)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sisl.io.siesta.tsvncSileSiesta.html" class="btn btn-neutral float-right" title="tsvncSileSiesta" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sisl.io.siesta.tsdeSileSiesta.html" class="btn btn-neutral float-left" title="tsdeSileSiesta" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2020, Nick Papior

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>